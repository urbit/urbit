::  kiln: grant userspace permissions to a desk
::
:-  %say
|=  $:  [now=@da eny=@uvJ bek=beak]
        [=desk pes=(list perm:gall)]
        [blocking=_| requested=_| all=_| ~]
    ==
:-  %helm-curb
^-  [^desk pers:gall]
=+  .^(=dome:clay %cx /(scot %p p.bek)//(scot %da now)/domes/(scot %tas desk))
:-  desk
%.  pes
%~  gas  in
%-  ~(uni in pes.dome)
?:  |(all &(blocking requested))
  %-  ~(uni in (~(uni in ask.dome) lac.dome))
  ?~(cop.dome *pers:gall mis.u.cop.dome)
?:  blocking
  (~(uni in lac.dome) ?~(cop.dome *pers:gall mis.u.cop.dome))
?:  requested
  ask.dome
*pers:gall
